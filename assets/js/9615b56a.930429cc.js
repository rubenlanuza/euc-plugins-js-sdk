"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[96],{3905:(e,n,a)=>{a.d(n,{Zo:()=>c,kt:()=>m});var t=a(67294);function l(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function i(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach((function(n){l(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function r(e,n){if(null==e)return{};var a,t,l=function(e,n){if(null==e)return{};var a,t,l={},i=Object.keys(e);for(t=0;t<i.length;t++)a=i[t],n.indexOf(a)>=0||(l[a]=e[a]);return l}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)a=i[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=t.createContext({}),p=function(e){var n=t.useContext(s),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},c=function(e){var n=p(e.components);return t.createElement(s.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},g=t.forwardRef((function(e,n){var a=e.components,l=e.mdxType,i=e.originalType,s=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),d=p(a),g=l,m=d["".concat(s,".").concat(g)]||d[g]||u[g]||i;return a?t.createElement(m,o(o({ref:n},c),{},{components:a})):t.createElement(m,o({ref:n},c))}));function m(e,n){var a=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var i=a.length,o=new Array(i);o[0]=g;var r={};for(var s in n)hasOwnProperty.call(n,s)&&(r[s]=n[s]);r.originalType=e,r[d]="string"==typeof e?e:l,o[1]=r;for(var p=2;p<i;p++)o[p]=a[p];return t.createElement.apply(null,o)}return t.createElement.apply(null,a)}g.displayName="MDXCreateElement"},38001:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>p});var t=a(87462),l=(a(67294),a(3905));const i={displayed_sidebar:"pluginsSidebar"},o="Plugins SDK API",r={unversionedId:"plugins/sdk",id:"plugins/sdk",title:"Plugins SDK API",description:"This part is still in the development process, changes may happen frequently.",source:"@site/docs/plugins/sdk.md",sourceDirName:"plugins",slug:"/plugins/sdk",permalink:"/euc-plugins-js-sdk/docs/plugins/sdk",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/plugins/sdk.md",tags:[],version:"current",frontMatter:{displayed_sidebar:"pluginsSidebar"},sidebar:"pluginsSidebar"},s={},p=[{value:"Lifecycle",id:"lifecycle",level:2},{value:"Initializing",id:"initializing",level:3},{value:"Getting the Context",id:"getting-the-context",level:3},{value:"Running",id:"running",level:3},{value:"Unloading",id:"unloading",level:3},{value:"Global Events",id:"global-events",level:2},{value:"Plugin&#39;s Interface Unloaded",id:"plugins-interface-unloaded",level:3},{value:"UI Listener",id:"ui-listener",level:4},{value:"Background Script Listener",id:"background-script-listener",level:4},{value:"User Logs Out",id:"user-logs-out",level:3},{value:"User Session Refreshed",id:"user-session-refreshed",level:3},{value:"E-UC Apps (Web and Desktop)",id:"wda",level:2},{value:"Methods",id:"methods",level:3},{value:"Opening and closing the left panel",id:"opening-and-closing-the-left-panel",level:4},{value:"Starting a call",id:"starting-a-call",level:4},{value:"Opening a link in the application",id:"opening-a-link-in-the-application",level:4},{value:"Creating a meeting",id:"creating-a-meeting",level:4},{value:"Opening a meeting lobby",id:"opening-a-meeting-lobby",level:4},{value:"Playing a sound",id:"playing-a-sound",level:4},{value:"Stopping a sound",id:"stopping-a-sound",level:4},{value:"Configuring sounds",id:"configuring-sounds",level:4},{value:"Resetting sounds",id:"resetting-sounds",level:4},{value:"Displaying a notification",id:"displaying-a-notification",level:4},{value:"Changing the navigation bar color",id:"changing-the-navigation-bar-color",level:4},{value:"Resetting the navigation bar color",id:"resetting-the-navigation-bar-color",level:4},{value:"Displaying a modal",id:"displaying-a-modal",level:4},{value:"Displaying a banner (mobile only)",id:"displaying-a-banner-mobile-only",level:4},{value:"Checking if a call has a local video stream",id:"checking-if-a-call-has-a-local-video-stream",level:4},{value:"Retrieving the local video stream of a call",id:"retrieving-the-local-video-stream-of-a-call",level:4},{value:"Checking if a call has a remote video stream",id:"checking-if-a-call-has-a-remote-video-stream",level:4},{value:"Retrieving the remote video stream of a call",id:"retrieving-the-remote-video-stream-of-a-call",level:4},{value:"Sending and receiving message between iframe and background script",id:"sending-and-receiving-message-between-iframe-and-background-script",level:4},{value:"Display a notification next to the navigation bar icon button",id:"display-a-notification-next-to-the-navigation-bar-icon-button",level:4},{value:"Events",id:"events",level:3},{value:"A call for the current user is incoming",id:"a-call-for-the-current-user-is-incoming",level:4},{value:"A call is made by the user (eg: outgoing call)",id:"a-call-is-made-by-the-user-eg-outgoing-call",level:4},{value:"An incoming call is answered by the current user",id:"an-incoming-call-is-answered-by-the-current-user",level:4},{value:"A call is answered (by one or the other side)",id:"a-call-is-answered-by-one-or-the-other-side",level:4},{value:"A call is hung up",id:"a-call-is-hung-up",level:4},{value:"Listening to Wazo Websocket message",id:"listening-to-wazo-websocket-message",level:4},{value:"Listening to meeting creation",id:"listening-to-meeting-creation",level:4},{value:"Listening navigation change in the app",id:"listening-navigation-change-in-the-app",level:4},{value:"Listening when a user enters a Room",id:"listening-when-a-user-enters-a-room",level:4},{value:"Listening when a user leavers a Room",id:"listening-when-a-user-leavers-a-room",level:4},{value:"Listening when a participant enters a Room",id:"listening-when-a-participant-enters-a-room",level:4},{value:"Listening when a participant leavers a Room",id:"listening-when-a-participant-leavers-a-room",level:4},{value:"E-UC Portal",id:"portal",level:2},{value:"Methods",id:"methods-1",level:3},{value:"Changing the display of the toolbar in a custom form",id:"changing-the-display-of-the-toolbar-in-a-custom-form",level:4},{value:"Events",id:"events-1",level:3},{value:"Check when the user is connected to a stack",id:"check-when-the-user-is-connected-to-a-stack",level:4},{value:"Check when the user is connected or switch to a tenant",id:"check-when-the-user-is-connected-or-switch-to-a-tenant",level:4},{value:"E-UC Mobile",id:"mobile",level:2},{value:"Methods",id:"methods-2",level:3},{value:"Change the header",id:"change-the-header",level:4},{value:"Show / hide bottom navigation",id:"show--hide-bottom-navigation",level:4}],c={toc:p};function d(e){let{components:n,...a}=e;return(0,l.kt)("wrapper",(0,t.Z)({},c,a,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"plugins-sdk-api"},"Plugins SDK API"),(0,l.kt)("admonition",{type:"caution"},(0,l.kt)("p",{parentName:"admonition"},"This part is still in the development process, changes may happen frequently.")),(0,l.kt)("p",null,"After installing the SDK, you can now require it with:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"import { App } from '@wazo/euc-plugins-sdk';\nconst app = new App();\n")),(0,l.kt)("h2",{id:"lifecycle"},"Lifecycle"),(0,l.kt)("p",null,"Plugins can be loaded and unloaded depending on some actions inside our product (ex: login/logout, tenant change, etc). Here's the lifecycle of a plugin with related listeners. That will help you build a robust system based on user actions."),(0,l.kt)("h3",{id:"initializing"},"Initializing"),(0,l.kt)("p",null,"It's ",(0,l.kt)("strong",{parentName:"p"},"required")," to call ",(0,l.kt)("inlineCode",{parentName:"p"},"app.initialize()")," function to registerer and acknowledge your plugin inside our E-UC Application. Please note this method is asynchronous."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"await app.initialize();\n")),(0,l.kt)("h3",{id:"getting-the-context"},"Getting the Context"),(0,l.kt)("p",null,"When the application is initialized, you can retrieve the context surrounding your plugin. A context will give you access to the app information that your plugin will base its logic on it."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import { Context } from '@wazo/euc-plugins-sdk/types';\nconst context: Context = app.getContext();\n")),(0,l.kt)("p",null,"Information that the context will give you access to:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"app: AppInfo"),": Information about the EUC application"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"locale: string"),": The locale code of the application on 2 characters, like ",(0,l.kt)("inlineCode",{parentName:"li"},"en")," or ",(0,l.kt)("inlineCode",{parentName:"li"},"it"),"."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"theme: Object"),": Colors used by the EUC app.\nIt uses the ",(0,l.kt)("a",{parentName:"li",href:"https://mui.com/material-ui/customization/palette/"},"Material UI theme")," palette structure, so you can use it directly with ",(0,l.kt)("inlineCode",{parentName:"li"},"createTheme()")," or just pick the color you want in your plugin."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"host: AppHostInfo"),": Contains a ",(0,l.kt)("inlineCode",{parentName:"li"},"clientType")," value that can be ",(0,l.kt)("inlineCode",{parentName:"li"},"web")," / ",(0,l.kt)("inlineCode",{parentName:"li"},"desktop")," / ",(0,l.kt)("inlineCode",{parentName:"li"},"ios")," or ",(0,l.kt)("inlineCode",{parentName:"li"},"android")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"extra: Object"),": Contains extra information about the app context, like the ",(0,l.kt)("inlineCode",{parentName:"li"},"contact")," when you use the ",(0,l.kt)("inlineCode",{parentName:"li"},"contactTab")," manifest context.\nAmong extra parameters, you'll always receive:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"extra.baseUrl"),": The base url of your ",(0,l.kt)("inlineCode",{parentName:"li"},"manifest.json")," file"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"extra.pluginId"),": The ",(0,l.kt)("inlineCode",{parentName:"li"},"entityId")," of the current plugin."))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"user: UserInfo"),": Information about the connected user in the EUC app:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"token: string"),": The token that can be used for API calls"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"refreshToken: string"),": A refresh token that should be used if the ",(0,l.kt)("inlineCode",{parentName:"li"},"token")," expires"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"uuid: string"),": The user uuid"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"host"),": In the web or desktop application: representing the stack hostname where the user is connected.\nSee the ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/wazo-communication/euc-plugins-js-sdk/blob/master/src/types.ts#L83"},(0,l.kt)("inlineCode",{parentName:"a"},"WDASession"))," and the ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/wazo-communication/euc-plugins-js-sdk/blob/master/src/types.ts#L79"},(0,l.kt)("inlineCode",{parentName:"a"},"PortalSession"))," types for more information.")))),(0,l.kt)("h3",{id:"running"},"Running"),(0,l.kt)("p",null,"It's at this moment the magic happens, add your own logic inside our products. Depending on which product you're developing, there are many listeners or action creators that you can use with the SDK."),(0,l.kt)("h3",{id:"unloading"},"Unloading"),(0,l.kt)("p",null,"When a plugin is unloaded because of a user action (ex: logout), this listener ",(0,l.kt)("inlineCode",{parentName:"p"},"app.onPluginUnLoaded()")," will be called. Other listeners will be disabled when unloaded. To prevent side effects, it's important to remove any watcher added in the initializing phase."),(0,l.kt)("p",null,"When the user logs in again, the ",(0,l.kt)("inlineCode",{parentName:"p"},"backgroundScript")," will be reloaded, please make sure to release everything in ",(0,l.kt)("inlineCode",{parentName:"p"},"onPluginUnLoaded"),"."),(0,l.kt)("admonition",{type:"info"},(0,l.kt)("p",{parentName:"admonition"},"If you're using a ",(0,l.kt)("strong",{parentName:"p"},"background script"),", it's important to close any WebSocket or listeners at this cycle of the plugin.")),(0,l.kt)("h2",{id:"global-events"},"Global Events"),(0,l.kt)("h3",{id:"plugins-interface-unloaded"},"Plugin's Interface Unloaded"),(0,l.kt)("h4",{id:"ui-listener"},"UI Listener"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onUnLoaded = () => {};\n")),(0,l.kt)("p",null,"It's a sugar of ",(0,l.kt)("inlineCode",{parentName:"p"},"window.onunload"),", useful when you want to store information before page/tab exit. ",(0,l.kt)("strong",{parentName:"p"},"Important:")," You can't do an action here like API call because the app (iframe) can be closed before the action will be finished."),(0,l.kt)("h4",{id:"background-script-listener"},"Background Script Listener"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onAppUnLoaded = (tabId) => {};\n")),(0,l.kt)("p",null,"Should be used in a ",(0,l.kt)("inlineCode",{parentName:"p"},"backgroundScript")," to know when a custom tab is unloaded. As ",(0,l.kt)("inlineCode",{parentName:"p"},"app.onUnLoaded")," is only triggered for tabs (iframes), and this event doesn't allow sophisticated actions (like sending messages to a background script, API calls, ...) we should use ",(0,l.kt)("inlineCode",{parentName:"p"},"onAppUnLoaded")," to perform an action when a tab is unloaded."),(0,l.kt)("h3",{id:"user-logs-out"},"User Logs Out"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onLogout = () => {};\n")),(0,l.kt)("h3",{id:"user-session-refreshed"},"User Session Refreshed"),(0,l.kt)("p",null,"The token of the authenticated user has an expiration date; when the token expires, a session is created with a new token."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onNewSession = (session:  WDASession | PortalSession) => {}\n")),(0,l.kt)("h2",{id:"wda"},"E-UC Apps (Web and Desktop)"),(0,l.kt)("h3",{id:"methods"},"Methods"),(0,l.kt)("h4",{id:"opening-and-closing-the-left-panel"},"Opening and closing the left panel"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.closeLeftPanel();\napp.openLeftPanel();\n")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"await app.initialize();\n// Closing the web/desktop left panel when the page is loaded\napp.closeLeftPanel();\n\napp.onUnLoaded = () => {\n  // Re-opening the panel when the page is unloaded\n  app.openLeftPanel();\n};\n")),(0,l.kt)("h4",{id:"starting-a-call"},"Starting a call"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.startCall({ targets , requestedModalities = ['audio'] });\n")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.startCall({ targets: ['8008'], requestedModalities: ['video'] });\n")),(0,l.kt)("h4",{id:"opening-a-link-in-the-application"},"Opening a link in the application"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.openLink(url: string);\n")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// Opening the internal phonebook\napp.openLink('/phonebook/internal');\n")),(0,l.kt)("h4",{id:"creating-a-meeting"},"Creating a meeting"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.createMeeting(name: string, requireAuthorization = false, persistent = false);\n")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.createMeeting('My meeting from my custom app', true, true);\n\n// Wait for the meeting to be available\napp.onMeetingCreated = newMeeting => {};\n")),(0,l.kt)("h4",{id:"opening-a-meeting-lobby"},"Opening a meeting lobby"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.openMeetingLobby(extension: string);\n")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// Open the lobby when a meeting is created\napp.onMeetingCreated = newMeeting => {\n  app.openMeetingLobby(newMeeting.exten);\n};\n")),(0,l.kt)("h1",{id:"ignoring-an-incoming-call"},"Ignoring an incoming call"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallIncoming = call => {\n  app.ignoreCall(call);\n};\n")),(0,l.kt)("h4",{id:"playing-a-sound"},"Playing a sound"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.playNewMessageSound(); // Play the sound when we receive a text message\napp.playIncomingCallSound(); // Play the incoming call sound (loop)\napp.playProgressSound(); // Play the ringback sound when we make a call (loop)\napp.playDoubleCallSound(); // Play the sound when another call is incoming\napp.playHangupSound(); // Play the hangup sound\n")),(0,l.kt)("h4",{id:"stopping-a-sound"},"Stopping a sound"),(0,l.kt)("p",null,'Sounds marked "loop" must be stopped using:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.stopCurrentSound();\n")),(0,l.kt)("h4",{id:"configuring-sounds"},"Configuring sounds"),(0,l.kt)("p",null,"You can use your own sound files in the application, with:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.configureSounds({\n  progress: 'http://example/com/progress.mpg', // Played when making an outgoing call (ringback)\n  ring: 'http://example/com/ring.wav', // Played for the first incoming call\n  message: 'http://example/com/message.ogg', // Played when the user receives a chat message\n  hangup: 'http://example/com/hangup.ogg',// Played when the call is hung up\n  inboundCall: 'http://example/com/inbound.vaw', // Played when we are in call and another call is incoming. Also played in Switchboard.\n})\n")),(0,l.kt)("p",null,"You can omit a value, the default sound will be used."),(0,l.kt)("h4",{id:"resetting-sounds"},"Resetting sounds"),(0,l.kt)("p",null,"You can reset all application sounds with:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.resetSounds();\n")),(0,l.kt)("h4",{id:"displaying-a-notification"},"Displaying a notification"),(0,l.kt)("p",null,"Wazo will display browser or desktop notification depending on the environment where WDA is running."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.displayNotification(title: string, text: string);\n")),(0,l.kt)("h4",{id:"changing-the-navigation-bar-color"},"Changing the navigation bar color"),(0,l.kt)("p",null,"We can change the navigation bar color with a valid CSS color:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.changeNavBarColor(color: string);\n")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.changeNavBarColor('#8e6a3a');\napp.changeNavBarColor('white');\n")),(0,l.kt)("h4",{id:"resetting-the-navigation-bar-color"},"Resetting the navigation bar color"),(0,l.kt)("p",null,"We can reset to the default navigation bar color with:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.resetNavBarColor();\n")),(0,l.kt)("h4",{id:"displaying-a-modal"},"Displaying a modal"),(0,l.kt)("p",null,"We can display a modal in the ",(0,l.kt)("inlineCode",{parentName:"p"},"backgroundScript")," with:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.displayModal({ url, title, text, htmlText, height, width, hideCloseButton });\n")),(0,l.kt)("p",null,"If ",(0,l.kt)("inlineCode",{parentName:"p"},"url")," is present, the modal will display an iframe with the content of the url.\nIf ",(0,l.kt)("inlineCode",{parentName:"p"},"htmlText")," is present, the modal will display this text in a html contact, otherwise the ",(0,l.kt)("inlineCode",{parentName:"p"},"text")," attribute will be used.\nThe ",(0,l.kt)("inlineCode",{parentName:"p"},"height")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"width")," accept valid CSS values, like ",(0,l.kt)("inlineCode",{parentName:"p"},"500px")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"80%"),".\n",(0,l.kt)("inlineCode",{parentName:"p"},"hideCloseButton")," (default to false) determines if the close button should be displayed, or if the user should handle closing of the modal in the html content (through ",(0,l.kt)("inlineCode",{parentName:"p"},"app.removeModal()")," method)."),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"On mobile, links with a ",(0,l.kt)("inlineCode",{parentName:"p"},'target="_blank"')," attribute will be opened in the user's default browser.")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("p",null,"Displaying client data when receiving a call"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallIncoming = async call => {\n  console.log('background onCallIncoming', call);\n  const clientData = await fetchClientData(call.number); // Where `fetchClientData` is a method that return client information from an extension\n\n  app.displayModal({\n    title: `Incoming call for ${call.displayName}`,\n    text: `Last call was: ${clientData.lastCall} for : ${clientData.lastCallSubject}`,\n    height: '50%',\n    width: '70%',\n  });\n};\n")),(0,l.kt)("h4",{id:"displaying-a-banner-mobile-only"},"Displaying a banner (mobile only)"),(0,l.kt)("p",null,"We can display a banner in the ",(0,l.kt)("inlineCode",{parentName:"p"},"backgroundScript")," with:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.displayBanner({ url, height, width, hideCloseButton });\n")),(0,l.kt)("p",null,"If ",(0,l.kt)("inlineCode",{parentName:"p"},"url")," is present, the modal will display an iframe with the content of the url.\nThe ",(0,l.kt)("inlineCode",{parentName:"p"},"height")," accepts valid CSS values, like ",(0,l.kt)("inlineCode",{parentName:"p"},"500px")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"80%"),".\nThe ",(0,l.kt)("inlineCode",{parentName:"p"},"width")," accepts valid CSS values, like ",(0,l.kt)("inlineCode",{parentName:"p"},"500px")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"80%"),", used on WDA (min: ",(0,l.kt)("inlineCode",{parentName:"p"},"300px"),").\n",(0,l.kt)("inlineCode",{parentName:"p"},"hideCloseButton")," (default to false) determines if the close button should be displayed, or if the user should handle closing of the modal in the html content (through ",(0,l.kt)("inlineCode",{parentName:"p"},"app.removeModal()")," method)."),(0,l.kt)("p",null,"We can then call ",(0,l.kt)("inlineCode",{parentName:"p"},"app.removeBanner()")," in the ",(0,l.kt)("inlineCode",{parentName:"p"},"backgroundScript")," or the loaded content."),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"On mobile, links with a ",(0,l.kt)("inlineCode",{parentName:"p"},'target="_blank"')," attribute will be opened in the user's default browser.")),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"On WDA, the banner will be integrated with other banners like incoming calls. Other banners will be displayed below.")),(0,l.kt)("h4",{id:"checking-if-a-call-has-a-local-video-stream"},"Checking if a call has a local video stream"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.hasLocalVideoStream(call: Call);\n")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallAnswered = (call) => {\n  const hasLocalVideo = app.hasLocalVideoStream(call);\n}\n")),(0,l.kt)("h4",{id:"retrieving-the-local-video-stream-of-a-call"},"Retrieving the local video stream of a call"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.getLocalCurrentVideoStream(call: Call);\n")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallAnswered = (call) => {\n  const stream = app.getLocalCurrentVideoStream(call);\n}\n")),(0,l.kt)("h4",{id:"checking-if-a-call-has-a-remote-video-stream"},"Checking if a call has a remote video stream"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.hasRemoteVideoStream(call: Call);\n")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallAnswered = (call) => {\n  const hasRemoteVideo = app.hasRemoteVideoStream(call);\n}\n")),(0,l.kt)("h4",{id:"retrieving-the-remote-video-stream-of-a-call"},"Retrieving the remote video stream of a call"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.getRemoteCurrentVideoStream(call: Call);\n")),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallAnswered = (call) => {\n  const stream = app.getRemoteCurrentVideoStream(call);\n}\n")),(0,l.kt)("h4",{id:"sending-and-receiving-message-between-iframe-and-background-script"},"Sending and receiving message between iframe and background script"),(0,l.kt)("p",null,"Inside an iframe"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// Sending message to background\napp.sendMessageToBackground({ value: 'ping' });\n\n// Receiving a message from the background script\napp.onIframeMessage = (msg) => {\n  console.log('onIframeMessage', msg);\n}\n")),(0,l.kt)("p",null,"In the background script"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// Sending a message to the iframe\napp.sendMessageToIframe({ value: 'pong' });\n\n// Receiving a message from the iframe\napp.onBackgroundMessage = msg => {\n  console.log('onBackgroundMessage', msg);\n}\n")),(0,l.kt)("h4",{id:"display-a-notification-next-to-the-navigation-bar-icon-button"},"Display a notification next to the navigation bar icon button"),(0,l.kt)("p",null,"Uses MUI's ",(0,l.kt)("a",{parentName:"p",href:"https://mui.com/material-ui/react-badge/"},"Badge")," component to display a notification, generally an integer. When used in ",(0,l.kt)("inlineCode",{parentName:"p"},"background.js"),", it requires ",(0,l.kt)("inlineCode",{parentName:"p"},"entityId")," as set in a tab in the ",(0,l.kt)("inlineCode",{parentName:"p"},"staticTabs")," section of ",(0,l.kt)("inlineCode",{parentName:"p"},"manifest.json"),', and that tab must include "sidebarTab" in its context (',(0,l.kt)("inlineCode",{parentName:"p"},"entityId")," should automatically be set when called from the iframe)."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.updateBadge({ badgeContent: number, color?: string = 'error', variant?: string, max?: number, overlap?: string, anchorOrigin?: Object, showZero?: boolean });\n")),(0,l.kt)("p",null,"\u26a0\ufe0f On Wazo Mobile, only the field ",(0,l.kt)("inlineCode",{parentName:"p"},"badgeContent: number")," is used to display the badge."),(0,l.kt)("h3",{id:"events"},"Events"),(0,l.kt)("h4",{id:"a-call-for-the-current-user-is-incoming"},"A call for the current user is incoming"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallIncoming = (call: Call) =>  {\n  // Useful to react in a `backgroundScript`.\n};\n")),(0,l.kt)("h4",{id:"a-call-is-made-by-the-user-eg-outgoing-call"},"A call is made by the user (eg: outgoing call)"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallMade = (call: Call) =>  {\n  // Useful to react in a `backgroundScript`.\n};\n")),(0,l.kt)("h4",{id:"an-incoming-call-is-answered-by-the-current-user"},"An incoming call is answered by the current user"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallAnswered = (call: Call) =>  {\n  // Useful to react in a `backgroundScript`.\n};\n")),(0,l.kt)("h4",{id:"a-call-is-answered-by-one-or-the-other-side"},"A call is answered (by one or the other side)"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallAccepted = (call: Call) =>  {\n  // Useful to react in a `backgroundScript`.\n};\n")),(0,l.kt)("h4",{id:"a-call-is-hung-up"},"A call is hung up"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onCallHungUp = (call: Call) =>  {\n  // Useful to react in a `backgroundScript`.\n};\n")),(0,l.kt)("h4",{id:"listening-to-wazo-websocket-message"},"Listening to Wazo Websocket message"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onWebsocketMessage = (message: MessageEvent) =>  {\n  // Useful to react in a `backgroundScript`.\n};\n")),(0,l.kt)("h4",{id:"listening-to-meeting-creation"},"Listening to meeting creation"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onMeetingCreated = (meeting: Meeting) =>  { };\n")),(0,l.kt)("h4",{id:"listening-navigation-change-in-the-app"},"Listening navigation change in the app"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onRouteChanged = (location: Object, action: string) =>  { };\n")),(0,l.kt)("h4",{id:"listening-when-a-user-enters-a-room"},"Listening when a user enters a Room"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onUserJoinRoom = (room) => {};\n")),(0,l.kt)("h4",{id:"listening-when-a-user-leavers-a-room"},"Listening when a user leavers a Room"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onUserLeaveRoom = (room) => {};\n")),(0,l.kt)("h4",{id:"listening-when-a-participant-enters-a-room"},"Listening when a participant enters a Room"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onParticipantJoinRoom = (room, participant) => {};\n")),(0,l.kt)("h4",{id:"listening-when-a-participant-leavers-a-room"},"Listening when a participant leavers a Room"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onParticipantLeaveRoom = (room, participant) => {};\n")),(0,l.kt)("h2",{id:"portal"},"E-UC Portal"),(0,l.kt)("h3",{id:"methods-1"},"Methods"),(0,l.kt)("h4",{id:"changing-the-display-of-the-toolbar-in-a-custom-form"},"Changing the display of the toolbar in a custom form"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.changeToolbarDisplay(displayed: boolean);\n")),(0,l.kt)("h3",{id:"events-1"},"Events"),(0,l.kt)("h4",{id:"check-when-the-user-is-connected-to-a-stack"},"Check when the user is connected to a stack"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onConnectedToStack = (stackSession: Object) => {};\n")),(0,l.kt)("h4",{id:"check-when-the-user-is-connected-or-switch-to-a-tenant"},"Check when the user is connected or switch to a tenant"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.onSwitchTenant = (uuid: string, name: string) => {};\n")),(0,l.kt)("h2",{id:"mobile"},"E-UC Mobile"),(0,l.kt)("h3",{id:"methods-2"},"Methods"),(0,l.kt)("h4",{id:"change-the-header"},"Change the header"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"title"),": Changes the label displayed in the header. Set this value to ",(0,l.kt)("inlineCode",{parentName:"p"},"null")," to set it back to the default value."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"callback"),": Handles the back button click. If a callback is registered, the app will forgo its normal behavior and run it. Setting the value to ",(0,l.kt)("inlineCode",{parentName:"p"},"null")," reinstates the original behavior."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.setMobileHeader({ title?: string | null, callback?: Function | null });\n")),(0,l.kt)("h4",{id:"show--hide-bottom-navigation"},"Show / hide bottom navigation"),(0,l.kt)("p",null,"Define whether you want to show or hide the bottom navigation"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"app.setMobileShowBottomNav(show: boolean);\n")))}d.isMDXComponent=!0}}]);